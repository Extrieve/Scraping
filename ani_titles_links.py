from Screenshot import Screenshot_Clipping
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.ui import WebDriverWait
import time

opt = webdriver.ChromeOptions()
# opt.add_argument('--headless')
opt.add_argument('--disable-gpu')
# opt.add_argument('--no-sandbox')
# opt.add_argument('--disable-dev-shm-usage')
resolution = "--window-size=1920,1080"
opt.add_argument(resolution)

# Initialize the service object
service = Service(r'C:\Selenium\chromedriver_win32\chromedriver.exe')
# path = r'C:\Selenium\chromedriver_win32\chromedriver.exe'
driver = webdriver.Chrome(service=service, options=opt)

# links = ['https://staging.animethemes.moe/wiki/anime/aharen_san_wa_hakarenai/OP', 'https://staging.animethemes.moe/wiki/anime/aharen_san_wa_hakarenai/ED', 'https://staging.animethemes.moe/wiki/anime/ao_ashi/OP', 'https://staging.animethemes.moe/wiki/anime/ao_ashi/ED', 'https://staging.animethemes.moe/wiki/anime/birdie_wing_golf_girls_story/OP', 'https://staging.animethemes.moe/wiki/anime/birdie_wing_golf_girls_story/ED', 'https://staging.animethemes.moe/wiki/anime/black_rock_shooter_dawn_fall/OP', 'https://staging.animethemes.moe/wiki/anime/black_rock_shooter_dawn_fall/ED', 'https://staging.animethemes.moe/wiki/anime/build_divide_code_white/OP', 'https://staging.animethemes.moe/wiki/anime/build_divide_code_white/ED', 'https://staging.animethemes.moe/wiki/anime/cap_kakumei_bottleman_dx/OP', 'https://staging.animethemes.moe/wiki/anime/dance_dance_danseur/OP', 'https://staging.animethemes.moe/wiki/anime/dance_dance_danseur/ED', 'https://staging.animethemes.moe/wiki/anime/date_a_live_iv/OP', 'https://staging.animethemes.moe/wiki/anime/date_a_live_iv/ED', 'https://staging.animethemes.moe/wiki/anime/deaimon/OP', 'https://staging.animethemes.moe/wiki/anime/deaimon/ED', 'https://staging.animethemes.moe/wiki/anime/estab_life_great_escape/OP', 'https://staging.animethemes.moe/wiki/anime/estab_life_great_escape/ED', 'https://staging.animethemes.moe/wiki/anime/gaikotsu_kishi_sama/OP', 'https://staging.animethemes.moe/wiki/anime/gaikotsu_kishi_sama/ED', 'https://staging.animethemes.moe/wiki/anime/gunjou_no_fanfare/OP', 'https://staging.animethemes.moe/wiki/anime/gunjou_no_fanfare/ED', 'https://staging.animethemes.moe/wiki/anime/healer_girl/OP', 'https://staging.animethemes.moe/wiki/anime/healer_girl/ED', 'https://staging.animethemes.moe/wiki/anime/heroine_tarumono/OP', 'https://staging.animethemes.moe/wiki/anime/heroine_tarumono/ED', 'https://staging.animethemes.moe/wiki/anime/honzuki_no_gekokujou_shisho_ni_naru_tame_ni_wa_shudan_wo_erandeiraremasen_3rd_season/OP', 'https://staging.animethemes.moe/wiki/anime/honzuki_no_gekokujou_shisho_ni_naru_tame_ni_wa_shudan_wo_erandeiraremasen_3rd_season/ED', 'https://staging.animethemes.moe/wiki/anime/insect_land/ED', 'https://staging.animethemes.moe/wiki/anime/kaginado_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/kaguya_sama_wa_kokurasetai_ultra_romantic/OP', 'https://staging.animethemes.moe/wiki/anime/kaguya_sama_wa_kokurasetai_ultra_romantic/ED', 'https://staging.animethemes.moe/wiki/anime/kawaii_dake_ja_nai_shikimori_san/OP', 'https://staging.animethemes.moe/wiki/anime/kawaii_dake_ja_nai_shikimori_san/ED', 'https://staging.animethemes.moe/wiki/anime/kingdom_4th_season/OP', 'https://staging.animethemes.moe/wiki/anime/kingdom_4th_season/ED', 'https://staging.animethemes.moe/wiki/anime/koi_wa_sekai_seifuku_no_ato_de/OP', 'https://staging.animethemes.moe/wiki/anime/koi_wa_sekai_seifuku_no_ato_de/ED', 'https://staging.animethemes.moe/wiki/anime/komi_san_wa_comyushou_desu_2nd_season/OP', 'https://staging.animethemes.moe/wiki/anime/komi_san_wa_comyushou_desu_2nd_season/ED', 'https://staging.animethemes.moe/wiki/anime/kono_healer_mendokusai/OP', 'https://staging.animethemes.moe/wiki/anime/kono_healer_mendokusai/ED', 'https://staging.animethemes.moe/wiki/anime/kunoichi_tsubaki_no_mune_no_uchi/OP', 'https://staging.animethemes.moe/wiki/anime/kunoichi_tsubaki_no_mune_no_uchi/ED1', 'https://staging.animethemes.moe/wiki/anime/kyoukai_senki_part_2/OP', 'https://staging.animethemes.moe/wiki/anime/kyoukai_senki_part_2/ED',
#          'https://staging.animethemes.moe/wiki/anime/love_all_play/OP', 'https://staging.animethemes.moe/wiki/anime/love_all_play/ED', 'https://staging.animethemes.moe/wiki/anime/love_live_nijigasaki_gakuen_school_idol_doukoukai_2nd_season/OP', 'https://staging.animethemes.moe/wiki/anime/love_live_nijigasaki_gakuen_school_idol_doukoukai_2nd_season/ED', 'https://staging.animethemes.moe/wiki/anime/machikado_mazoku_2_choume/OP', 'https://staging.animethemes.moe/wiki/anime/machikado_mazoku_2_choume/ED', 'https://staging.animethemes.moe/wiki/anime/magia_record_mahou_shoujo_madoka_magica_gaiden_tv_final_season_asaki_yume_no_akatsuki/OP-1080', 'https://staging.animethemes.moe/wiki/anime/magia_record_mahou_shoujo_madoka_magica_gaiden_tv_final_season_asaki_yume_no_akatsuki/ED1-1080', 'https://staging.animethemes.moe/wiki/anime/mahoutsukai_reimeiki/OP', 'https://staging.animethemes.moe/wiki/anime/mahoutsukai_reimeiki/ED', 'https://staging.animethemes.moe/wiki/anime/meitantei_conan_zero_no_tea_time/OP', 'https://staging.animethemes.moe/wiki/anime/meitantei_conan_zero_no_tea_time/ED', 'https://staging.animethemes.moe/wiki/anime/onipan/ED', 'https://staging.animethemes.moe/wiki/anime/mobseka/OP', 'https://staging.animethemes.moe/wiki/anime/mobseka/ED', 'https://staging.animethemes.moe/wiki/anime/paripi_koumei/OP', 'https://staging.animethemes.moe/wiki/anime/paripi_koumei/ED1', 'https://staging.animethemes.moe/wiki/anime/rikei_ga_koi_ni_ochita_no_de_shoumei_shitemita_heart/OP', 'https://staging.animethemes.moe/wiki/anime/rikei_ga_koi_ni_ochita_no_de_shoumei_shitemita_heart/ED', 'https://staging.animethemes.moe/wiki/anime/rpg_fudousan/OP', 'https://staging.animethemes.moe/wiki/anime/rpg_fudousan/ED', 'https://staging.animethemes.moe/wiki/anime/shachiku_san_wa_youjo_yuurei_ni_iyasaretai/OP', 'https://staging.animethemes.moe/wiki/anime/shachiku_san_wa_youjo_yuurei_ni_iyasaretai/ED', 'https://staging.animethemes.moe/wiki/anime/shadowverse_flame/OP', 'https://staging.animethemes.moe/wiki/anime/shadowverse_flame/ED', 'https://staging.animethemes.moe/wiki/anime/murabito_a/OP', 'https://staging.animethemes.moe/wiki/anime/murabito_a/ED', 'https://staging.animethemes.moe/wiki/anime/shokei_shoujo_no_virgin_road/OP', 'https://staging.animethemes.moe/wiki/anime/shokei_shoujo_no_virgin_road/ED', 'https://staging.animethemes.moe/wiki/anime/spy_x_family/OP', 'https://staging.animethemes.moe/wiki/anime/summer_time_render/OP', 'https://staging.animethemes.moe/wiki/anime/summer_time_render/ED', 'https://staging.animethemes.moe/wiki/anime/tate_no_yuusha_no_nariagari_season_2/OP', 'https://staging.animethemes.moe/wiki/anime/tate_no_yuusha_no_nariagari_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/thermae_romae_novae/OP', 'https://staging.animethemes.moe/wiki/anime/tiger_bunny_2/OP', 'https://staging.animethemes.moe/wiki/anime/tiger_bunny_2/ED', 'https://staging.animethemes.moe/wiki/anime/tomodachi_game/OP', 'https://staging.animethemes.moe/wiki/anime/tomodachi_game/ED', 'https://staging.animethemes.moe/wiki/anime/ultraman_season_2/OP', 'https://staging.animethemes.moe/wiki/anime/ultraman_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/yatogame_chan_kansatsu_nikki_4th_season/ED', 'https://staging.animethemes.moe/wiki/anime/yu_gi_oh_go_rush/OP', 'https://staging.animethemes.moe/wiki/anime/yu_gi_oh_go_rush/ED', 'https://staging.animethemes.moe/wiki/anime/yuusha_yamemasu/OP', 'https://staging.animethemes.moe/wiki/anime/yuusha_yamemasu/ED']

links = ['https://staging.animethemes.moe/wiki/anime/aharen_san_wa_hakarenai/OP', 'https://staging.animethemes.moe/wiki/anime/aharen_san_wa_hakarenai/ED', 'https://staging.animethemes.moe/wiki/anime/ao_ashi/OP', 'https://staging.animethemes.moe/wiki/anime/ao_ashi/ED', 'https://staging.animethemes.moe/wiki/anime/birdie_wing_golf_girls_story/OP', 'https://staging.animethemes.moe/wiki/anime/birdie_wing_golf_girls_story/ED', 'https://staging.animethemes.moe/wiki/anime/black_rock_shooter_dawn_fall/OP', 'https://staging.animethemes.moe/wiki/anime/black_rock_shooter_dawn_fall/ED', 'https://staging.animethemes.moe/wiki/anime/build_divide_code_white/OP', 'https://staging.animethemes.moe/wiki/anime/build_divide_code_white/ED', 'https://staging.animethemes.moe/wiki/anime/cap_kakumei_bottleman_dx/OP', 'https://staging.animethemes.moe/wiki/anime/dance_dance_danseur/OP', 'https://staging.animethemes.moe/wiki/anime/dance_dance_danseur/ED', 'https://staging.animethemes.moe/wiki/anime/date_a_live_iv/OP', 'https://staging.animethemes.moe/wiki/anime/date_a_live_iv/ED', 'https://staging.animethemes.moe/wiki/anime/deaimon/OP', 'https://staging.animethemes.moe/wiki/anime/deaimon/ED', 'https://staging.animethemes.moe/wiki/anime/estab_life_great_escape/OP', 'https://staging.animethemes.moe/wiki/anime/estab_life_great_escape/ED', 'https://staging.animethemes.moe/wiki/anime/gaikotsu_kishi_sama/OP', 'https://staging.animethemes.moe/wiki/anime/gaikotsu_kishi_sama/ED', 'https://staging.animethemes.moe/wiki/anime/gunjou_no_fanfare/OP', 'https://staging.animethemes.moe/wiki/anime/gunjou_no_fanfare/ED', 'https://staging.animethemes.moe/wiki/anime/healer_girl/OP', 'https://staging.animethemes.moe/wiki/anime/healer_girl/ED', 'https://staging.animethemes.moe/wiki/anime/heroine_tarumono/OP', 'https://staging.animethemes.moe/wiki/anime/heroine_tarumono/ED', 'https://staging.animethemes.moe/wiki/anime/honzuki_no_gekokujou_shisho_ni_naru_tame_ni_wa_shudan_wo_erandeiraremasen_3rd_season/OP', 'https://staging.animethemes.moe/wiki/anime/honzuki_no_gekokujou_shisho_ni_naru_tame_ni_wa_shudan_wo_erandeiraremasen_3rd_season/ED', 'https://staging.animethemes.moe/wiki/anime/insect_land/ED', 'https://staging.animethemes.moe/wiki/anime/kaginado_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/kaguya_sama_wa_kokurasetai_ultra_romantic/OP', 'https://staging.animethemes.moe/wiki/anime/kaguya_sama_wa_kokurasetai_ultra_romantic/ED', 'https://staging.animethemes.moe/wiki/anime/kakkou_no_iinazuke/OP', 'https://staging.animethemes.moe/wiki/anime/kakkou_no_iinazuke/ED', 'https://staging.animethemes.moe/wiki/anime/kawaii_dake_ja_nai_shikimori_san/OP', 'https://staging.animethemes.moe/wiki/anime/kawaii_dake_ja_nai_shikimori_san/ED', 'https://staging.animethemes.moe/wiki/anime/kingdom_4th_season/OP', 'https://staging.animethemes.moe/wiki/anime/kingdom_4th_season/ED', 'https://staging.animethemes.moe/wiki/anime/koi_wa_sekai_seifuku_no_ato_de/OP', 'https://staging.animethemes.moe/wiki/anime/koi_wa_sekai_seifuku_no_ato_de/ED', 'https://staging.animethemes.moe/wiki/anime/komi_san_wa_comyushou_desu_2nd_season/OP', 'https://staging.animethemes.moe/wiki/anime/komi_san_wa_comyushou_desu_2nd_season/ED', 'https://staging.animethemes.moe/wiki/anime/kono_healer_mendokusai/OP', 'https://staging.animethemes.moe/wiki/anime/kono_healer_mendokusai/ED', 'https://staging.animethemes.moe/wiki/anime/kunoichi_tsubaki_no_mune_no_uchi/OP', 'https://staging.animethemes.moe/wiki/anime/kunoichi_tsubaki_no_mune_no_uchi/ED1', 'https://staging.animethemes.moe/wiki/anime/kyoukai_senki_part_2/OP',
         'https://staging.animethemes.moe/wiki/anime/kyoukai_senki_part_2/ED', 'https://staging.animethemes.moe/wiki/anime/love_all_play/OP', 'https://staging.animethemes.moe/wiki/anime/love_all_play/ED', 'https://staging.animethemes.moe/wiki/anime/love_live_nijigasaki_gakuen_school_idol_doukoukai_2nd_season/OP', 'https://staging.animethemes.moe/wiki/anime/love_live_nijigasaki_gakuen_school_idol_doukoukai_2nd_season/ED', 'https://staging.animethemes.moe/wiki/anime/machikado_mazoku_2_choume/OP', 'https://staging.animethemes.moe/wiki/anime/machikado_mazoku_2_choume/ED', 'https://staging.animethemes.moe/wiki/anime/magia_record_mahou_shoujo_madoka_magica_gaiden_tv_final_season_asaki_yume_no_akatsuki/OP-1080', 'https://staging.animethemes.moe/wiki/anime/magia_record_mahou_shoujo_madoka_magica_gaiden_tv_final_season_asaki_yume_no_akatsuki/ED1-1080', 'https://staging.animethemes.moe/wiki/anime/mahoutsukai_reimeiki/OP', 'https://staging.animethemes.moe/wiki/anime/mahoutsukai_reimeiki/ED', 'https://staging.animethemes.moe/wiki/anime/meitantei_conan_zero_no_tea_time/OP', 'https://staging.animethemes.moe/wiki/anime/meitantei_conan_zero_no_tea_time/ED', 'https://staging.animethemes.moe/wiki/anime/onipan/ED', 'https://staging.animethemes.moe/wiki/anime/mobseka/OP', 'https://staging.animethemes.moe/wiki/anime/mobseka/ED', 'https://staging.animethemes.moe/wiki/anime/paripi_koumei/OP', 'https://staging.animethemes.moe/wiki/anime/paripi_koumei/ED1', 'https://staging.animethemes.moe/wiki/anime/rikei_ga_koi_ni_ochita_no_de_shoumei_shitemita_heart/OP', 'https://staging.animethemes.moe/wiki/anime/rikei_ga_koi_ni_ochita_no_de_shoumei_shitemita_heart/ED', 'https://staging.animethemes.moe/wiki/anime/rpg_fudousan/OP', 'https://staging.animethemes.moe/wiki/anime/rpg_fudousan/ED', 'https://staging.animethemes.moe/wiki/anime/shachiku_san_wa_youjo_yuurei_ni_iyasaretai/OP', 'https://staging.animethemes.moe/wiki/anime/shachiku_san_wa_youjo_yuurei_ni_iyasaretai/ED', 'https://staging.animethemes.moe/wiki/anime/shadowverse_flame/OP', 'https://staging.animethemes.moe/wiki/anime/shadowverse_flame/ED', 'https://staging.animethemes.moe/wiki/anime/murabito_a/OP', 'https://staging.animethemes.moe/wiki/anime/murabito_a/ED', 'https://staging.animethemes.moe/wiki/anime/shokei_shoujo_no_virgin_road/OP', 'https://staging.animethemes.moe/wiki/anime/shokei_shoujo_no_virgin_road/ED', 'https://staging.animethemes.moe/wiki/anime/spy_x_family/OP', 'https://staging.animethemes.moe/wiki/anime/spy_x_family/ED', 'https://staging.animethemes.moe/wiki/anime/summer_time_render/OP', 'https://staging.animethemes.moe/wiki/anime/summer_time_render/ED', 'https://staging.animethemes.moe/wiki/anime/tate_no_yuusha_no_nariagari_season_2/OP', 'https://staging.animethemes.moe/wiki/anime/tate_no_yuusha_no_nariagari_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/thermae_romae_novae/OP', 'https://staging.animethemes.moe/wiki/anime/tiger_bunny_2/OP', 'https://staging.animethemes.moe/wiki/anime/tiger_bunny_2/ED', 'https://staging.animethemes.moe/wiki/anime/tomodachi_game/OP', 'https://staging.animethemes.moe/wiki/anime/tomodachi_game/ED', 'https://staging.animethemes.moe/wiki/anime/ultraman_season_2/OP', 'https://staging.animethemes.moe/wiki/anime/ultraman_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/yatogame_chan_kansatsu_nikki_4th_season/ED', 'https://staging.animethemes.moe/wiki/anime/yu_gi_oh_go_rush/OP', 'https://staging.animethemes.moe/wiki/anime/yu_gi_oh_go_rush/ED', 'https://staging.animethemes.moe/wiki/anime/yuusha_yamemasu/OP', 'https://staging.animethemes.moe/wiki/anime/yuusha_yamemasu/ED']

# driver.get(links[0])

themes = {}

for link in links:
    driver.get(link)
    time.sleep(2)
# print all text in driver
    for title in driver.find_element(By.TAG_NAME, 'div').find_elements(By.TAG_NAME, 'small'):
        try:
            if 'from ' in title.text:
                title = str(title.text)
                index = title.find('from ')
                theme = title[index+5:]
                video = driver.find_element(By.TAG_NAME, 'video')
                src = video.get_attribute('src')
                print(theme, src)
                if theme not in themes:
                    themes[theme] = []
                    themes[theme].append(src)
                else:
                    themes[theme].append(src)
        except:
            pass

driver.close()
driver.quit()
print(themes)
