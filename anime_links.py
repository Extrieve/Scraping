from Screenshot import Screenshot_Clipping
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.ui import WebDriverWait
import time

opt = webdriver.ChromeOptions()
# opt.add_argument('--headless')
opt.add_argument('--disable-gpu')
# opt.add_argument('--no-sandbox')
# opt.add_argument('--disable-dev-shm-usage')
resolution = "--window-size=1920,1080"
opt.add_argument(resolution)

# Initialize the service object
service = Service(r'C:\Selenium\chromedriver_win32\chromedriver.exe')
# path = r'C:\Selenium\chromedriver_win32\chromedriver.exe'
driver = webdriver.Chrome(service=service, options=opt)

links = ['https://staging.animethemes.moe/wiki/anime/aharen_san_wa_hakarenai/OP', 'https://staging.animethemes.moe/wiki/anime/aharen_san_wa_hakarenai/ED', 'https://staging.animethemes.moe/wiki/anime/ao_ashi/OP', 'https://staging.animethemes.moe/wiki/anime/ao_ashi/ED', 'https://staging.animethemes.moe/wiki/anime/birdie_wing_golf_girls_story/OP', 'https://staging.animethemes.moe/wiki/anime/birdie_wing_golf_girls_story/ED', 'https://staging.animethemes.moe/wiki/anime/black_rock_shooter_dawn_fall/OP', 'https://staging.animethemes.moe/wiki/anime/black_rock_shooter_dawn_fall/ED', 'https://staging.animethemes.moe/wiki/anime/build_divide_code_white/OP', 'https://staging.animethemes.moe/wiki/anime/build_divide_code_white/ED', 'https://staging.animethemes.moe/wiki/anime/cap_kakumei_bottleman_dx/OP', 'https://staging.animethemes.moe/wiki/anime/dance_dance_danseur/OP', 'https://staging.animethemes.moe/wiki/anime/dance_dance_danseur/ED', 'https://staging.animethemes.moe/wiki/anime/date_a_live_iv/OP', 'https://staging.animethemes.moe/wiki/anime/date_a_live_iv/ED', 'https://staging.animethemes.moe/wiki/anime/deaimon/OP', 'https://staging.animethemes.moe/wiki/anime/deaimon/ED', 'https://staging.animethemes.moe/wiki/anime/estab_life_great_escape/OP', 'https://staging.animethemes.moe/wiki/anime/estab_life_great_escape/ED', 'https://staging.animethemes.moe/wiki/anime/gaikotsu_kishi_sama/OP', 'https://staging.animethemes.moe/wiki/anime/gaikotsu_kishi_sama/ED', 'https://staging.animethemes.moe/wiki/anime/gunjou_no_fanfare/OP', 'https://staging.animethemes.moe/wiki/anime/gunjou_no_fanfare/ED', 'https://staging.animethemes.moe/wiki/anime/healer_girl/OP', 'https://staging.animethemes.moe/wiki/anime/healer_girl/ED', 'https://staging.animethemes.moe/wiki/anime/heroine_tarumono/OP', 'https://staging.animethemes.moe/wiki/anime/heroine_tarumono/ED', 'https://staging.animethemes.moe/wiki/anime/honzuki_no_gekokujou_shisho_ni_naru_tame_ni_wa_shudan_wo_erandeiraremasen_3rd_season/OP', 'https://staging.animethemes.moe/wiki/anime/honzuki_no_gekokujou_shisho_ni_naru_tame_ni_wa_shudan_wo_erandeiraremasen_3rd_season/ED', 'https://staging.animethemes.moe/wiki/anime/insect_land/ED', 'https://staging.animethemes.moe/wiki/anime/kaginado_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/kaguya_sama_wa_kokurasetai_ultra_romantic/OP', 'https://staging.animethemes.moe/wiki/anime/kaguya_sama_wa_kokurasetai_ultra_romantic/ED', 'https://staging.animethemes.moe/wiki/anime/kawaii_dake_ja_nai_shikimori_san/OP', 'https://staging.animethemes.moe/wiki/anime/kawaii_dake_ja_nai_shikimori_san/ED', 'https://staging.animethemes.moe/wiki/anime/kingdom_4th_season/OP', 'https://staging.animethemes.moe/wiki/anime/kingdom_4th_season/ED', 'https://staging.animethemes.moe/wiki/anime/koi_wa_sekai_seifuku_no_ato_de/OP', 'https://staging.animethemes.moe/wiki/anime/koi_wa_sekai_seifuku_no_ato_de/ED', 'https://staging.animethemes.moe/wiki/anime/komi_san_wa_comyushou_desu_2nd_season/OP', 'https://staging.animethemes.moe/wiki/anime/komi_san_wa_comyushou_desu_2nd_season/ED', 'https://staging.animethemes.moe/wiki/anime/kono_healer_mendokusai/OP', 'https://staging.animethemes.moe/wiki/anime/kono_healer_mendokusai/ED', 'https://staging.animethemes.moe/wiki/anime/kunoichi_tsubaki_no_mune_no_uchi/OP', 'https://staging.animethemes.moe/wiki/anime/kunoichi_tsubaki_no_mune_no_uchi/ED1', 'https://staging.animethemes.moe/wiki/anime/kyoukai_senki_part_2/OP', 'https://staging.animethemes.moe/wiki/anime/kyoukai_senki_part_2/ED',
         'https://staging.animethemes.moe/wiki/anime/love_all_play/OP', 'https://staging.animethemes.moe/wiki/anime/love_all_play/ED', 'https://staging.animethemes.moe/wiki/anime/love_live_nijigasaki_gakuen_school_idol_doukoukai_2nd_season/OP', 'https://staging.animethemes.moe/wiki/anime/love_live_nijigasaki_gakuen_school_idol_doukoukai_2nd_season/ED', 'https://staging.animethemes.moe/wiki/anime/machikado_mazoku_2_choume/OP', 'https://staging.animethemes.moe/wiki/anime/machikado_mazoku_2_choume/ED', 'https://staging.animethemes.moe/wiki/anime/magia_record_mahou_shoujo_madoka_magica_gaiden_tv_final_season_asaki_yume_no_akatsuki/OP-1080', 'https://staging.animethemes.moe/wiki/anime/magia_record_mahou_shoujo_madoka_magica_gaiden_tv_final_season_asaki_yume_no_akatsuki/ED1-1080', 'https://staging.animethemes.moe/wiki/anime/mahoutsukai_reimeiki/OP', 'https://staging.animethemes.moe/wiki/anime/mahoutsukai_reimeiki/ED', 'https://staging.animethemes.moe/wiki/anime/meitantei_conan_zero_no_tea_time/OP', 'https://staging.animethemes.moe/wiki/anime/meitantei_conan_zero_no_tea_time/ED', 'https://staging.animethemes.moe/wiki/anime/onipan/ED', 'https://staging.animethemes.moe/wiki/anime/mobseka/OP', 'https://staging.animethemes.moe/wiki/anime/mobseka/ED', 'https://staging.animethemes.moe/wiki/anime/paripi_koumei/OP', 'https://staging.animethemes.moe/wiki/anime/paripi_koumei/ED1', 'https://staging.animethemes.moe/wiki/anime/rikei_ga_koi_ni_ochita_no_de_shoumei_shitemita_heart/OP', 'https://staging.animethemes.moe/wiki/anime/rikei_ga_koi_ni_ochita_no_de_shoumei_shitemita_heart/ED', 'https://staging.animethemes.moe/wiki/anime/rpg_fudousan/OP', 'https://staging.animethemes.moe/wiki/anime/rpg_fudousan/ED', 'https://staging.animethemes.moe/wiki/anime/shachiku_san_wa_youjo_yuurei_ni_iyasaretai/OP', 'https://staging.animethemes.moe/wiki/anime/shachiku_san_wa_youjo_yuurei_ni_iyasaretai/ED', 'https://staging.animethemes.moe/wiki/anime/shadowverse_flame/OP', 'https://staging.animethemes.moe/wiki/anime/shadowverse_flame/ED', 'https://staging.animethemes.moe/wiki/anime/murabito_a/OP', 'https://staging.animethemes.moe/wiki/anime/murabito_a/ED', 'https://staging.animethemes.moe/wiki/anime/shokei_shoujo_no_virgin_road/OP', 'https://staging.animethemes.moe/wiki/anime/shokei_shoujo_no_virgin_road/ED', 'https://staging.animethemes.moe/wiki/anime/spy_x_family/OP', 'https://staging.animethemes.moe/wiki/anime/summer_time_render/OP', 'https://staging.animethemes.moe/wiki/anime/summer_time_render/ED', 'https://staging.animethemes.moe/wiki/anime/tate_no_yuusha_no_nariagari_season_2/OP', 'https://staging.animethemes.moe/wiki/anime/tate_no_yuusha_no_nariagari_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/thermae_romae_novae/OP', 'https://staging.animethemes.moe/wiki/anime/tiger_bunny_2/OP', 'https://staging.animethemes.moe/wiki/anime/tiger_bunny_2/ED', 'https://staging.animethemes.moe/wiki/anime/tomodachi_game/OP', 'https://staging.animethemes.moe/wiki/anime/tomodachi_game/ED', 'https://staging.animethemes.moe/wiki/anime/ultraman_season_2/OP', 'https://staging.animethemes.moe/wiki/anime/ultraman_season_2/ED', 'https://staging.animethemes.moe/wiki/anime/yatogame_chan_kansatsu_nikki_4th_season/ED', 'https://staging.animethemes.moe/wiki/anime/yu_gi_oh_go_rush/OP', 'https://staging.animethemes.moe/wiki/anime/yu_gi_oh_go_rush/ED', 'https://staging.animethemes.moe/wiki/anime/yuusha_yamemasu/OP', 'https://staging.animethemes.moe/wiki/anime/yuusha_yamemasu/ED']

themes = []
for link in links:
    try:
        driver.get(link)
        video = driver.find_element(By.TAG_NAME, 'video')
        # get video src
        src = video.get_attribute('src')
        themes.append(src)
        # wait 2 seconds
        time.sleep(2)
    except:
        pass

driver.close()
driver.quit()
print(themes)

## themes
# ['https://staging.animethemes.moe/video/AharenSanWaHakarenai-OP1.webm', 'https://staging.animethemes.moe/video/AharenSanWaHakarenai-ED1.webm', 'https://staging.animethemes.moe/video/AoAshi-OP1.webm', 'https://staging.animethemes.moe/video/AoAshi-ED1.webm', 'https://staging.animethemes.moe/video/BirdieWing-OP1.webm', 'https://staging.animethemes.moe/video/BirdieWing-ED1.webm', 'https://staging.animethemes.moe/video/BlackRockShooterDawnFall-OP1.webm', 'https://staging.animethemes.moe/video/BlackRockShooterDawnFall-ED1.webm', 'https://staging.animethemes.moe/video/BuildDivideCodeWhite-OP1.webm', 'https://staging.animethemes.moe/video/BuildDivideCodeWhite-ED1.webm', 'https://staging.animethemes.moe/video/CapKakumeiBottlemanDX-OP1.webm', 'https://staging.animethemes.moe/video/DanceDanceDanseur-OP1.webm', 'https://staging.animethemes.moe/video/DanceDanceDanseur-ED1.webm', 'https://staging.animethemes.moe/video/DateALiveS4-OP1.webm', 'https://staging.animethemes.moe/video/DateALiveS4-ED1.webm', 'https://staging.animethemes.moe/video/Deaimon-OP1.webm', 'https://staging.animethemes.moe/video/Deaimon-ED1.webm', 'https://staging.animethemes.moe/video/EstabLife-OP1.webm', 'https://staging.animethemes.moe/video/EstabLife-ED1.webm', 'https://staging.animethemes.moe/video/GaikotsuKishi-OP1.webm', 'https://staging.animethemes.moe/video/GaikotsuKishi-ED1.webm', 'https://staging.animethemes.moe/video/GunjouNoFanfare-OP1.webm', 'https://staging.animethemes.moe/video/GunjouNoFanfare-ED1.webm', 'https://staging.animethemes.moe/video/HealerGirl-OP1.webm', 'https://staging.animethemes.moe/video/HealerGirl-ED1.webm', 'https://staging.animethemes.moe/video/HeroineTarumono-OP1.webm', 'https://staging.animethemes.moe/video/HeroineTarumono-ED1.webm', 'https://staging.animethemes.moe/video/HonzukiNoGekokujouS3-OP1.webm', 'https://staging.animethemes.moe/video/HonzukiNoGekokujouS3-ED1.webm', 'https://staging.animethemes.moe/video/InsectLand-ED1.webm', 'https://staging.animethemes.moe/video/KaginadoS2-ED1.webm', 'https://staging.animethemes.moe/video/KaguyaSamaWaKokurasetaiS3-OP1.webm', 'https://staging.animethemes.moe/video/KaguyaSamaWaKokurasetaiS3-ED1.webm', 'https://staging.animethemes.moe/video/Shikimori-OP1.webm', 'https://staging.animethemes.moe/video/Shikimori-ED1.webm', 'https://staging.animethemes.moe/video/KingdomS4-OP1.webm', 'https://staging.animethemes.moe/video/KingdomS4-ED1.webm', 'https://staging.animethemes.moe/video/Koiseka-OP1.webm', 'https://staging.animethemes.moe/video/Koiseka-ED1.webm', 'https://staging.animethemes.moe/video/KomiSanWaKomyushouDesuS2-OP1.webm', 'https://staging.animethemes.moe/video/KomiSanWaKomyushouDesuS2-ED1.webm', 'https://staging.animethemes.moe/video/KonoHealerMendokusai-OP1.webm', 'https://staging.animethemes.moe/video/KonoHealerMendokusai-ED1.webm', 'https://staging.animethemes.moe/video/KunoichiTsubaki-OP1.webm', 'https://staging.animethemes.moe/video/KunoichiTsubaki-ED1.webm', 'https://staging.animethemes.moe/video/KyoukaiSenkiS2-OP1.webm', 'https://staging.animethemes.moe/video/KyoukaiSenkiS2-ED1.webm', 'https://staging.animethemes.moe/video/LoveAllPlay-OP1.webm', 'https://staging.animethemes.moe/video/LoveAllPlay-ED1.webm', 'https://staging.animethemes.moe/video/LoveLiveNijigasakiGakuenS2-OP1.webm', 'https://staging.animethemes.moe/video/LoveLiveNijigasakiGakuenS2-ED1.webm', 'https://staging.animethemes.moe/video/MachikadoMazokuS2-OP1.webm', 'https://staging.animethemes.moe/video/MachikadoMazokuS2-ED1.webm', 'https://staging.animethemes.moe/video/MagiaRecordS3-OP1.webm', 'https://staging.animethemes.moe/video/MagiaRecordS2-ED1.webm', 'https://staging.animethemes.moe/video/MahoutsukaiReimeiki-OP1.webm', 'https://staging.animethemes.moe/video/MahoutsukaiReimeiki-ED1.webm', 'https://staging.animethemes.moe/video/ZeroNoTeaTime-OP1.webm', 'https://staging.animethemes.moe/video/ZeroNoTeaTime-ED1.webm', 'https://staging.animethemes.moe/video/Onipan-ED1.webm', 'https://staging.animethemes.moe/video/Mobseka-OP1.webm', 'https://staging.animethemes.moe/video/Mobseka-ED1.webm', 'https://staging.animethemes.moe/video/ParipiKoumei-OP1.webm', 'https://staging.animethemes.moe/video/ParipiKoumei-ED1.webm', 'https://staging.animethemes.moe/video/RikeKoiS2-OP1.webm', 'https://staging.animethemes.moe/video/RikeKoiS2-ED1.webm', 'https://staging.animethemes.moe/video/RPGFudousan-OP1.webm', 'https://staging.animethemes.moe/video/RPGFudousan-ED1.webm', 'https://staging.animethemes.moe/video/Shachisaretai-OP1.webm', 'https://staging.animethemes.moe/video/Shachisaretai-ED1.webm', 'https://staging.animethemes.moe/video/ShadowverseFlame-OP1.webm', 'https://staging.animethemes.moe/video/ShadowverseFlame-ED1.webm', 'https://staging.animethemes.moe/video/MurabitoA-OP1.webm', 'https://staging.animethemes.moe/video/MurabitoA-ED1.webm', 'https://staging.animethemes.moe/video/ShokeiShoujoNoVirginRoad-OP1.webm', 'https://staging.animethemes.moe/video/ShokeiShoujoNoVirginRoad-ED1.webm', 'https://staging.animethemes.moe/video/SpyXFamily-OP1.webm', 'https://staging.animethemes.moe/video/SummertimeRender-OP1.webm', 'https://staging.animethemes.moe/video/SummertimeRender-ED1.webm', 'https://staging.animethemes.moe/video/ShieldHeroS2-OP1.webm', 'https://staging.animethemes.moe/video/ShieldHeroS2-ED1.webm', 'https://staging.animethemes.moe/video/ThermaeRomaeNovae-OP1.webm', 'https://staging.animethemes.moe/video/TigerAndBunnyS2-OP1.webm', 'https://staging.animethemes.moe/video/TigerAndBunnyS2-ED1.webm', 'https://staging.animethemes.moe/video/TomodachiGame-OP1.webm', 'https://staging.animethemes.moe/video/TomodachiGame-ED1.webm', 'https://staging.animethemes.moe/video/UltramanS2-OP1.webm', 'https://staging.animethemes.moe/video/UltramanS2-ED1.webm', 'https://staging.animethemes.moe/video/YatogameChanKansatsuNikkiS4-ED1.webm', 'https://staging.animethemes.moe/video/YGOGoRush-OP1.webm', 'https://staging.animethemes.moe/video/YGOGoRush-ED1.webm', 'https://staging.animethemes.moe/video/YuushaYamemasu-OP1.webm', 'https://staging.animethemes.moe/video/YuushaYamemasu-ED1.webm']
